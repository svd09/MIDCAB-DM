library(easypackages)
libraries(c("tidyverse","rms","Hmisc","survival",
"tableone", "readxl","survminer"))
# getting the dataset.
df <- read_csv("D:\\MIDCAB_DM\\midcab_dm.csv")
glimpse(df)
df %>% count(`Coronary_ disease_detail`)
# plan to only keep clean single vessel disease patients here.
df1 <- df %>% filter(`Coronary_ disease_detail` == 1) %>%
rename(cor_details = `Coronary_ disease_detail`)
# now df1 contains only LIMA - LAD patients here.
glimpse(df1)
df1 %>% count(Diabetes)
# here we have 346 patients with DM and 1110 without.
df1 %>% count(`Oral_ antidiabetics` )
df1 %>% count(Insulin)
df1 %>% count(`Oral_ antidiabetics` )
df1 %>% count(Insulin)
df1$survyears <- ( 1 + df1$Survival_days)/365.24
s <- survfit(Surv(survyears, Died_total) ~ Diabetes, data = df1)
ggsurvplot(s, conf.int = T, risk.table = T,
censor.size = 0, xlim = c(0,20))
glimpse(df1)
library(easypackages)
libraries(c("tidyverse","rms","Hmisc","survival",
"tableone", "readxl","survminer"))
knitr::opts_chunk$set(echo = TRUE)
library(easypackages)
libraries(c("tidyverse","rms","Hmisc","survival",
"tableone", "readxl","survminer"))
# getting the dataset.
df <- read_csv("D:\\MIDCAB_DM\\midcab_dm.csv")
str(df)
df %>% count(`Coronary_ disease_detail`)
df %>% count(cad)
df1 <- df %>% filter(cad == 1)
df1 %>% count(Diabetes)
df1 %>% count(diabetes)
df1 %>% count(ohga)
df1 %>% count(insulin)
df1$diet_rx = with(df1, ifelse(diabetes == 1 & ohga == 1 & insulin == 0 , 1, 0))
df1 %>% count(diet_rx)
df1$treat <- with(df1, ifelse(diabetes == 1 & diet_rx == 1, 1,
ifelse(diabetes == 1 & ohga == 1, 2,
ifelse(diabetes == 1 & insulin == 1, 3, 0))))
df1 %>% count(treat)
str(df1)
df1$treat = factor(df1$treat, levels = c(0,1,2,3),
labels = c("no_dm","oral","meds","insulin"))
df1$survyears = (1 + df1$Survival_days)/365.24
s <- survfit(Surv(survyears, Died_total) ~ treat, data = df1)
ggsurvplot(s, conf.int = T,risk.table = T,
censor.size = 0)
df1$survyears = (1 + df1$Survival_days)/365.24
s <- survfit(Surv(survyears, Died_total) ~ treat, data = df1)
s2 <- survfit(Surv(survyears, Died_total) ~ diabetes, data = df1)
ggsurvplot(s, conf.int = T,risk.table = T,
censor.size = 0)
ggsurvplot(s2, conf.int = T,risk.table = T,
censor.size = 0)
df1$itdm <- with(df1, ifelse(diabetes == 1 & insulin == 1, 2,
diabetes == 1 & insulin == 0, 1, 0))
df1$itdm <- with(df1, ifelse(diabetes == 1 & insulin == 1, 2,
ifelse(diabetes == 1 & insulin == 0, 1, 0)))
df1$itdm = factor(df1$itdm, levels = c(0,1,2),
labels = c("no_dm","non_itdm","itdm"))
library(easypackages)
libraries(c("tidyverse","rms","Hmisc","survival",
"tableone", "readxl","survminer","naniar"))
colnames(df1)[apply(df1,2,-9)]
colnames(df1)[apply(df1,2,is(-9))]
colnames(df1)[apply(df1,2,anyNA)]
describe(df1[,1:20])
replace(df1$bmi, df1$bmi < 0, NA)
df1$bmi <- replace(df1$bmi, df1$bmi < 0, NA)
describe(df1$bmi)
df1 = df1 %>% rename(preop_dialysis = `Preop_ dialysis`)
describe(df1[, 21:50])
dput(names(df1[, 21:50]))
describe(df1[, 21:50])
dput(names(df1[, 21:50]))
df2 <- read_csv("D:\\MIDCAB_DM\\midcab_dm2.csv")
describe(df2)
library(easypackages)
libraries(c("tidyverse","rms","Hmisc","survival",
"tableone", "readxl","survminer","naniar"))
# getting the dataset.
df <- read_csv("D:\\MIDCAB_DM\\midcab_dm2.csv")
# str(df)
df %>% count(cad)
df1 <- df %>% filter(cad == 1)
# now df1 contains only LIMA - LAD patients here.
# glimpse(df1)
df1 %>% count(diabetes)
# here we have 346 patients with DM and 1110 without.
df1 %>% count(ohga)
df1 %>% count(insulin)
# we also have diet treated DM.
df1$diet_rx = with(df1, ifelse(diabetes == 1 & ohga == 1 & insulin == 0 , 1, 0))
df1 %>% count(diet_rx)
# so for the dm patients, make a var for treatment. diet = 1, ohga = 2, insulin = 3
df1$treat <- with(df1, ifelse(diabetes == 1 & diet_rx == 1, 1,
ifelse(diabetes == 1 & ohga == 1, 2,
ifelse(diabetes == 1 & insulin == 1, 3, 0))))
df1 %>% count(treat)
df1$treat = factor(df1$treat, levels = c(0,1,2,3),
labels = c("no_dm","oral","meds","insulin"))
df1$itdm <- with(df1, ifelse(diabetes == 1 & insulin == 1, 2,
ifelse(diabetes == 1 & insulin == 0, 1, 0)))
df1$itdm = factor(df1$itdm, levels = c(0,1,2),
labels = c("no_dm","non_itdm","itdm"))
df1$survyears = (1 + df1$Survival_days)/365.24
s <- survfit(Surv(survyears, Died_total) ~ treat, data = df1)
s2 <- survfit(Surv(survyears, Died_total) ~ diabetes, data = df1)
s3 <- survfit(Surv(survyears, Died_total) ~ itdm, data = df1)
ggsurvplot(s, conf.int = T,risk.table = T,
censor.size = 0)
ggsurvplot(s2, conf.int = T,risk.table = T,
censor.size = 0)
ggsurvplot(s3, conf.int = T,risk.table = T,
censor.size = 0)
describe(df1[,2:20])
dput(names(df1[, 2:20]))
dput(names(df1[, 2:24]))
dput(names(df1[, 2:30]))
dput(names(df1[, 2:35]))
dput(names(df1[, 2:40]))
vars <- c( "time_period",  "age", "sex",
"bmi", "diabetes", "ohga", "insulin", "newer_antidm",
"preop_aspirin", "preop_plavix",  "preop_creat_mg",
"Preop_ dialysis", "htn", "pah", "smoke", "hyperlip",
"copd", "pvd", "lvef", "lvfuncion", "ekg", "priority", "critical_state",
"preop_cpr", "preop_vent", "cad", "lmca_d", "prior_pci", "pci_vessel")
factors <- c( "time_period",  "sex",
"diabetes", "ohga", "insulin", "newer_antidm",
"preop_aspirin", "preop_plavix",
"Preop_ dialysis", "htn", "pah", "smoke", "hyperlip",
"copd", "pvd",  "lvfuncion", "ekg", "priority", "critical_state",
"preop_cpr", "preop_vent", "cad", "lmca_d", "prior_pci", "pci_vessel")
t1 <- tableone::CreateTableOne(vars = vars, factorVars = factors,
strata = c("diabetes"),
data = df1)
print(t1, nonnormal = c("age","preop_creat_mg"))
dput(names(df1[, 35:50]))
dput(names(df1[, 35:70]))
knitr::opts_chunk$set(echo = TRUE)
options(width = 100)
describe(df1$cpb_time)
df1 %>% count(cpb_time)
df1$pump_used <- with(df1, ifelse(cpb_time == 0, 0 ,1))
df1 %>% count(convert_onpump)
df1 %>% count(pump_used)
df1$pump_used <- with(df1, ifelse(cpb_time == 0, 0 ,1))
df1 %>% count(convert_onpump)
df1 %>% count(pump_used)
describe(df1$cpb_time)
df1 %>% count(cpb_time)
vars <- c("prior_pci", "preop_mi", "inc_revasc", "preop_stroke", "preop_cva",
"preop_cs", "prior_ohs",  "log_euroscore",
"convert_onpump", "on_bh", "convert_sternotomy",
"surg_time", "cpb_time", "clamp_time", "postop_locas", "post_iabp",
"post_ecmo", "post_mi", "postop_cpr", "postop_af", "post_bypass_revise" ,"pump_used")
factors <-
c("prior_pci", "preop_mi", "inc_revasc", "preop_stroke", "preop_cva",
"preop_cs", "prior_ohs",  "log_euroscore",
"convert_onpump", "on_bh", "convert_sternotomy",
"surg_time", "cpb_time", "clamp_time", "postop_locas", "post_iabp",
"post_ecmo", "post_mi", "postop_cpr", "postop_af", "post_bypass_revise" ,"pump_used")
t2 <- tableone::CreateTableOne(vars = vars,
factorVars = factors,
strata = c("diabetes"),
data = df1)
print(t2)
df1$pump_used <- with(df1, ifelse(cpb_time == 0, 0 ,1))
df1 %>% count(convert_onpump)
df1 %>% count(pump_used)
describe(df1$cpb_time)
df1 %>% count(cpb_time)
vars <- c("prior_pci", "preop_mi", "inc_revasc", "preop_stroke", "preop_cva",
"preop_cs", "prior_ohs",  "log_euroscore",
"convert_onpump", "on_bh", "convert_sternotomy",
"surg_time", "cpb_time", "clamp_time", "postop_locas", "post_iabp",
"post_ecmo", "post_mi", "postop_cpr", "postop_af", "post_bypass_revise" ,"pump_used")
factors <-
c("prior_pci", "preop_mi", "inc_revasc", "preop_stroke", "preop_cva",
"preop_cs", "prior_ohs",
"convert_onpump", "on_bh", "convert_sternotomy",
"surg_time", "cpb_time", "clamp_time", "postop_locas", "post_iabp",
"post_ecmo", "post_mi", "postop_cpr", "postop_af", "post_bypass_revise" ,"pump_used")
t2 <- tableone::CreateTableOne(vars = vars,
factorVars = factors,
strata = c("diabetes"),
data = df1)
print(t2)
df1$pump_used <- with(df1, ifelse(cpb_time == 0, 0 ,1))
df1 %>% count(convert_onpump)
df1 %>% count(pump_used)
describe(df1$cpb_time)
df1 %>% count(cpb_time)
vars <- c("prior_pci", "preop_mi", "inc_revasc", "preop_stroke", "preop_cva",
"preop_cs", "prior_ohs",  "log_euroscore",
"convert_onpump", "on_bh", "convert_sternotomy",
"surg_time", "cpb_time", "clamp_time", "postop_locas", "post_iabp",
"post_ecmo", "post_mi", "postop_cpr", "postop_af", "post_bypass_revise" ,"pump_used")
factors <-
c("prior_pci", "preop_mi", "inc_revasc", "preop_stroke", "preop_cva",
"preop_cs", "prior_ohs",
"convert_onpump", "on_bh", "convert_sternotomy",
"postop_locas", "post_iabp",
"post_ecmo", "post_mi", "postop_cpr", "postop_af", "post_bypass_revise" ,"pump_used")
t2 <- tableone::CreateTableOne(vars = vars,
factorVars = factors,
strata = c("diabetes"),
data = df1)
print(t2)
knit_with_parameters('D:/MIDCAB_DM/MIDCAB-DM/mkd1.Rmd')
knitr::opts_chunk$set(echo = TRUE)
library(Statamarkdown)
library(easypackages)
libraries(c("tidyverse","rms","Hmisc","survival",
"tableone", "readxl","survminer","naniar"))
# getting the dataset.
df <- read_csv("D:\\MIDCAB_DM\\midcab_dm2.csv")
# str(df)
df %>% count(cad)
